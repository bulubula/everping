{% extends "base.html" %}
{% block content %}
<div class="card mb-3">
  <div class="card-body d-flex justify-content-between align-items-center flex-wrap gap-3 py-2">
    <div>
      <h2 class="mb-0">Alerts</h2>
      <div class="text-muted small">Latest 200 alert events.</div>
    </div>
    <div>
      <form action="{{ request.url_for('alerts_clear') }}" method="post">
        <button type="submit" class="btn btn-outline-danger" onclick="return confirm('Clear all alerts?')">Clear</button>
      </form>
    </div>
  </div>
</div>
<div class="table-responsive">
<table class="table table-striped align-middle">
  <thead>
    <tr><th>TS</th><th>Task</th><th>Type</th><th>Message</th><th>Suppressed</th></tr>
  </thead>
  <tbody>
  {% for a in alerts %}
  <tr>
    <td>{{ a.ts }}</td>
    <td>{{ tasks.get(a.task_id).name if tasks.get(a.task_id) else a.task_id }}</td>
    <td>{{ a.alert_type }}</td>
    <td>{{ a.message }}</td>
    <td>{{ "yes" if a.suppressed else "no" }}</td>
  </tr>
  {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}
