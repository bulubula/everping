{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2 class="mb-3">New Task</h2>
  {% if error %}
  <div class="text-danger mb-2">{{ error }}</div>
  {% endif %}
  <form method="post" action="/tasks/new" class="d-flex" style="flex-direction:column; gap:0.75rem;">
    <div>
      <label>Name</label>
      <input class="form-control" name="name" required>
    </div>
    <div>
      <label>Type</label>
      <select name="type">
        <option value="schedule">schedule</option>
        <option value="monitor">monitor</option>
      </select>
    </div>
    <div>
      <label>Job</label>
      <select name="job_id">
        <option value="">-- select job --</option>
        {% for j in jobs %}
          <option value="{{ j.id }}">{{ j.id }}</option>
        {% endfor %}
      </select>
    </div>
    <div>
      <label>Enabled</label>
      <select name="enabled">
        <option value="1">1</option>
        <option value="0">0</option>
      </select>
    </div>
    <div>
      <label>Remark</label>
      <textarea class="form-control" name="remark" rows="3" placeholder="Notes..."></textarea>
    </div>
    <hr>
    <div>
      <label>Trigger</label>
      <select name="trigger_type">
        <option value="none">none</option>
        <option value="interval">interval</option>
        <option value="cron">cron</option>
        <option value="deadline">deadline</option>
      </select>
    </div>
    <div>
      <label>Interval seconds</label>
      <input class="form-control" type="number" name="interval_sec" value="" min="1">
    </div>
    <div>
      <label>Cron (min hour dom mon dow)</label>
      <input class="form-control" name="cron_expr" placeholder="*/5 * * * *">
    </div>
    <div>
      <label>Deadline at (YYYY-MM-DDTHH:MM:SS)</label>
      <input class="form-control" name="deadline_at" placeholder="2025-01-31T23:59:59">
    </div>
    <div class="d-flex gap-2">
      <div style="flex:1;">
        <label>Start before days</label>
        <input class="form-control" type="number" name="start_before_days" value="1" min="0">
      </div>
      <div style="flex:1;">
        <label>Interval hours</label>
        <input class="form-control" type="number" name="interval_hours" value="6" min="0">
      </div>
    </div>
    <div>
      <label>Holiday policy</label>
      <select name="holiday_policy">
        <option>NONE</option>
        <option>CN_WORKDAY_ONLY</option>
        <option>SKIP_CN_HOLIDAY</option>
        <option>SKIP_CN_WORKDAY</option>
      </select>
    </div>
    <button class="btn" type="submit">Create</button>
  </form>
</div>
{% endblock %}
